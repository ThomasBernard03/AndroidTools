name: Build macOS App

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: macos-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: '15.1'  

    - name: Build the project
      run: xcodebuild -project AndroidTools/AndroidTools.xcodeproj -scheme AndroidTools -sdk macosx CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO

    - name: Archive the project
      run: xcodebuild -project YourProject.xcodeproj -scheme YourScheme -sdk macosx -configuration Release archive -archivePath ${{github.workspace}}/build/YourApp.xcarchive

    - name: Export the archive
      run: xcodebuild -exportArchive -archivePath ${{github.workspace}}/build/AndroidTools.xcarchive -exportPath ${{github.workspace}}/build -exportOptionsPlist ExportOptions.plist

    - name: Upload Artifacts
      uses: actions/upload-artifact@v2
      with:
        name: YourApp
        path: ${{github.workspace}}/build/*.ipa
